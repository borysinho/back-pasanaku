generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum EstadoJuego {
  Nuevo
  EnviandoInvitaciones
  ListoParaEmpezar
  Iniciado
  Finalizado
}

enum Moneda {
  BS
  US
}

model Juegos{
  id Int @id @default(autoincrement())

  estado_juego EstadoJuego @default(Nuevo)
  moneda Moneda @default(BS)

  nombre String
  fecha_inicio DateTime @db.Date
  monto_total Int

  jugadores_juegos Jugadores_Juegos[]
  invitados_juegos Invitados_Juegos[]
  turnos Turnos[]
}


model Invitados{
  
  id Int @id @default(autoincrement())
  correo String @unique
  telf String @unique
  invitados_juegos Invitados_Juegos[]
  jugadores_invitados Jugadores_Invitados[]
  jugadores Jugadores[]
}

model Jugadores_Invitados {
  id_jugador Int @unique
  id_invitado Int @unique
  jugador Jugadores @relation(fields: [id_jugador], references: [id])
  invitado Invitados @relation(fields: [id_invitado], references: [id])
}

enum EstadoNotificacion {
  EnvioCorrecto
  EnvioIncorrecto
}

enum EstadoInvitacion {
  NoEnviado
  Enviado
  Aceptado
  Rechazado
  Cancelado

}
model Invitados_Juegos {

  id_invitado Int
  id_juego Int

  invitado Invitados @relation(fields: [id_invitado], references: [id], onDelete: Cascade)
  juego Juegos @relation(fields: [id_juego], references: [id], onDelete: Cascade)

  @@id(name: "id", fields: [id_invitado, id_juego])

  estado_invitacion EstadoInvitacion @default(NoEnviado)
  estado_notificacion_whatsapp EstadoNotificacion @default(EnvioCorrecto)
  estado_notificacion_correo EstadoNotificacion @default(EnvioCorrecto)
  nombre_invitado String
  fecha DateTime? @default(now())
}

enum Periodos {
  Semanal
  Quincenal
  Mensual
  Personalizado
}

model Turnos {
  id Int @id @default(autoincrement())
  
  juego Juegos @relation(fields: [id_juego], references: [id], onDelete: Cascade)
  id_juego Int

  fecha_turno DateTime? @default(now())

  jugador_grupo_turno Jugador_Grupo_Turno[]
}

model Jugadores {
  id Int @id @default(autoincrement())
  id_invitado Int

  invitado Invitados @relation(fields: [id_invitado], references: [id], onDelete: NoAction)

  jugadores_juegos Jugadores_Juegos[]
  jugadores_invitados Jugadores_Invitados[]

  nombre String
  usuario String
  contrasena String
}

enum Roles {
  Creador
  Jugador
}

enum Estado_Jugadores_Juego {
  Participando
  RetiroForzoso
  RetiroVoluntario
}

model Jugadores_Juegos {
  id Int @id @default(autoincrement())

  jugador Jugadores @relation(fields: [id_jugador], references: [id], onDelete: Cascade)
  juego Juegos @relation(fields: [id_juego], references: [id], onDelete: Cascade)
  jugador_grupo_turno Jugador_Grupo_Turno[]
  rol Roles @default(Jugador)
  estado Estado_Jugadores_Juego @default(Participando)

  id_jugador Int
  id_juego Int

  fecha_ingreso DateTime? @default(now())
}

model Jugador_Grupo_Turno {


  jugadores_juegos Jugadores_Juegos @relation(fields: [id_jugador_juego], references: [id], onDelete: Cascade)
  turno Turnos @relation(fields: [id_turno], references: [id], onDelete: Cascade)

  id_jugador_juego Int
  id_turno Int

  @@id(name: "id", [id_jugador_juego, id_turno])
}
